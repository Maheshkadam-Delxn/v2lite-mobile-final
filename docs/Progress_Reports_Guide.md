# ðŸ“Š Progress Reports Module Guide

This guide explains the flow for Daily, Weekly, and Monthly progress reporting in the app.

## ðŸ”„ Module Workflow

The Progress Reporting module consists of two main parts:
1. **Logging Execution (Daily)**: Managers/Workers log what work was done on site today.
2. **Viewing Reports (Summary)**: The app aggregates these logs to show Daily, Weekly, and Monthly progress summaries.

---

## 1. Daily Progress Logging (Input)

**User Action:**
- User goes to "Work Progress" screen.
- Taps "+" button to add a new log.
- Selects a Milestone (optional), enters Description, sets Effort % (0-100), and adds Photos.

**Key Rule:** 
- Total effort for a single day across all logs cannot exceed 100%.

**API Endpoint:**
- **Method:** `POST`
- **URL:** `/api/work-progress`
- **Header:** `Authorization: Bearer <TOKEN>`

**Request Body:**
```json
{
  "projectId": "651a...",        // Required
  "milestoneId": "652b...",      // Optional (Links work to a specific milestone)
  "description": "Completed foundation pouring.", // Required
  "effortPercentage": 40,        // Required (Integer 0-100)
  "photos": [                    // Optional
    "https://cloudinary.com/..."
  ],
  "logDate": "2024-01-23T10:00:00Z" // Auto-generated by app
}
```

---

## 2. Viewing Progress (History)

**User Action:**
- User opens "Work Progress" screen.
- Default tab is **"History"**.
- Shows a timeline list of all daily logs submitted.

**API Endpoint:**
- **Method:** `GET`
- **URL:** `/api/work-progress`
- **Query Params:**
  - `projectId`: `<PROJECT_ID>` (Required)

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "_id": "...",
      "description": "Completed foundation pouring.",
      "effortPercentage": 40,
      "logDate": "2024-01-23",
      "photos": ["..."],
      "createdBy": { "name": "Site Manager" }
    }
    // ... more logs
  ]
}
```

---

## 3. Progress Reports (Daily / Weekly / Monthly)

**User Action:**
- User switches to **"Reports"** tab on "Work Progress" screen.
- App displays three summary cards:
  1. **Daily Progress**: Summary for today.
  2. **Weekly Summary**: Aggregated data for the current week.
  3. **Monthly Overview**: Aggregated data for the current month.

**API Endpoint:**
- **Method:** `GET`
- **URL:** `/api/work-progress/summary`
- **Query Params:**
  - `projectId`: `<PROJECT_ID>` (Required)
  - `type`: `daily` | `weekly` | `monthly`

**Request Example:**
`GET /api/work-progress/summary?projectId=123&type=weekly`

**Response:**
```json
{
  "success": true,
  "data": {
    "totalLogs": 5,             // Number of logs submitted in this period
    "totalEffort": 85,          // Sum of effort percentages (capped logic may apply on backend)
    "averageEffort": 17,        // Average effort per log
    "period": "weekly"
  }
}
```

---

## ðŸ“ Implementation Details (Frontend)

- **File:** `src/screens/WorkProgress/WorkProgressListScreen.jsx`
  - Handles fetching both History (Logs) and Reports (Summaries).
  - Fetches all 3 summaries (daily, weekly, monthly) in parallel when "Reports" tab is active.
  
- **File:** `src/services/WorkProgressService.js`
  - Contains `createLog`, `getLogs`, and `getSummary` methods.

---

## ðŸš€ Testing Steps

1. **Log Work**: Go to Work Progress -> Add -> Submit a log with 50% effort.
2. **Verify History**: Check "History" tab to see your new log.
3. **Verify Report**: Switch to "Reports" tab.
   - **Daily**: Should show 50% total effort (if this was the only log today).
   - **Weekly/Monthly**: Should update to reflect this new addition.
